{% extends 'base.html' %}
{% load static %}

{% block title %}Panel de Administración - VeriHome{% endblock %}

{% block extra_css %}
<style>
    .stats-card {
        background-color: #1F2937;
        border-radius: 0.5rem;
        padding: 1.5rem;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        transition: transform 0.3s ease;
    }
    
    .stats-card:hover {
        transform: translateY(-5px);
    }
    
    .stats-number {
        font-size: 2.5rem;
        font-weight: 700;
        color: #F59E0B;
    }
    
    .stats-label {
        color: #E5E7EB;
        font-size: 1rem;
        margin-top: 0.5rem;
    }
    
    .user-list {
        background-color: #1F2937;
        border-radius: 0.5rem;
        padding: 1.5rem;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    
    .user-item {
        display: flex;
        align-items: center;
        padding: 0.75rem;
        border-bottom: 1px solid #374151;
        transition: background-color 0.2s ease;
    }
    
    .user-item:hover {
        background-color: #374151;
    }
    
    .user-avatar {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background-color: #F59E0B;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        color: white;
        margin-right: 1rem;
    }
    
    .user-info {
        flex: 1;
    }
    
    .user-name {
        color: #E5E7EB;
        font-weight: 600;
    }
    
    .user-type {
        color: #9CA3AF;
        font-size: 0.875rem;
    }
    
    .user-date {
        color: #9CA3AF;
        font-size: 0.75rem;
    }
    
    .user-status {
        padding: 0.25rem 0.5rem;
        border-radius: 9999px;
        font-size: 0.75rem;
        font-weight: 600;
    }
    
    .status-verified {
        background-color: #10B981;
        color: white;
    }
    
    .status-unverified {
        background-color: #EF4444;
        color: white;
    }
    
    .action-button {
        background-color: #F59E0B;
        color: white;
        padding: 0.5rem 1rem;
        border-radius: 0.375rem;
        font-weight: 600;
        transition: background-color 0.2s ease;
        text-align: center;
        display: inline-block;
    }
    
    .action-button:hover {
        background-color: #D97706;
    }
</style>
{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-8">
    <h1 class="text-3xl font-bold text-white mb-8">Panel de Administración</h1>
    
    <!-- Estadísticas -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
        <div class="stats-card">
            <div class="stats-number">{{ total_users }}</div>
            <div class="stats-label">Usuarios Totales</div>
            <div class="flex mt-4 text-sm">
                <div class="mr-4">
                    <span class="text-green-500">{{ verified_users }}</span> Verificados
                </div>
                <div>
                    <span class="text-red-500">{{ unverified_users }}</span> Sin verificar
                </div>
            </div>
        </div>
        
        <div class="stats-card">
            <div class="stats-number">{{ total_codes }}</div>
            <div class="stats-label">Códigos de Entrevista</div>
            <div class="flex mt-4 text-sm">
                <div class="mr-4">
                    <span class="text-green-500">{{ available_codes }}</span> Disponibles
                </div>
                <div>
                    <span class="text-gray-500">{{ used_codes }}</span> Utilizados
                </div>
            </div>
        </div>
        
        <div class="stats-card">
            <div class="flex justify-between">
                <div>
                    <div class="text-xl font-bold text-amber-500">{{ arrendadores }}</div>
                    <div class="text-gray-400">Arrendadores</div>
                </div>
                <div>
                    <div class="text-xl font-bold text-amber-500">{{ arrendatarios }}</div>
                    <div class="text-gray-400">Arrendatarios</div>
                </div>
                <div>
                    <div class="text-xl font-bold text-amber-500">{{ prestadores }}</div>
                    <div class="text-gray-400">Prestadores</div>
                </div>
            </div>
            <div class="mt-4">
                <a href="{% url 'generate_codes' %}" class="action-button block w-full">
                    <i class="ri-add-line mr-1"></i> Generar Códigos
                </a>
            </div>
        </div>
    </div>
    
    <!-- Usuarios Recientes -->
    <div class="mb-8">
        <h2 class="text-xl font-bold text-white mb-4">Usuarios Recientes</h2>
        <div class="user-list">
            {% for user in recent_users %}
                <div class="user-item">
                    <div class="user-avatar">
                        {% if user.profile_picture %}
                            <img src="{{ user.profile_picture.url }}" alt="{{ user.name }}" class="w-full h-full object-cover rounded-full">
                        {% else %}
                            {{ user.name|first|upper }}
                        {% endif %}
                    </div>
                    <div class="user-info">
                        <div class="user-name">{{ user.name }}</div>
                        <div class="user-type">{{ user.get_profile_type_display }}</div>
                    </div>
                    <div class="mr-4 text-right">
                        <div class="user-date">{{ user.date_joined|date:"d/m/Y H:i" }}</div>
                        <div class="mt-1">
                            {% if user.is_verified %}
                                <span class="user-status status-verified">Verificado</span>
                            {% else %}
                                <span class="user-status status-unverified">Sin verificar</span>
                            {% endif %}
                        </div>
                    </div>
                    {% if not user.is_verified %}
                        <a href="{% url 'verify_user' user.id %}" class="action-button">Verificar</a>
                    {% endif %}
                </div>
            {% empty %}
                <p class="text-gray-400 p-4 text-center">No hay usuarios recientes.</p>
            {% endfor %}
        </div>
    </div>
    
    <!-- Enlaces Rápidos -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
        <a href="{% url 'admin:real_estate_auth_customuser_changelist' %}" class="stats-card">
            <i class="ri-user-settings-line text-3xl text-amber-500 mb-2"></i>
            <div class="text-white font-bold">Gestionar Usuarios</div>
            <div class="text-gray-400 text-sm mt-1">Administrar todos los usuarios del sistema</div>
        </a>
        
        <a href="{% url 'admin:real_estate_auth_interviewcode_changelist' %}" class="stats-card">
            <i class="ri-key-line text-3xl text-amber-500 mb-2"></i>
            <div class="text-white font-bold">Gestionar Códigos</div>
            <div class="text-gray-400 text-sm mt-1">Administrar códigos de entrevista</div>
        </a>
        
        <a href="{% url 'admin:index' %}" class="stats-card">
            <i class="ri-dashboard-line text-3xl text-amber-500 mb-2"></i>
            <div class="text-white font-bold">Admin Django</div>
            <div class="text-gray-400 text-sm mt-1">Acceder al panel de administración de Django</div>
        </a>
    </div>
</div>
{% endblock %}